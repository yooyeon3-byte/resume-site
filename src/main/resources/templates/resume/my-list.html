<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{fragments/layout}">
<body>
<th:block layout:fragment="content">
    <div class="page-header">
        <h2>내 이력서</h2>
        <a th:href="@{/resumes/new}" class="btn-primary small">새 이력서 작성</a>
    </div>

    <div class="grid">
        <div class="card" th:each="resume : ${resumes}">
            <h3 th:text="${resume.title}">제목</h3>
            <p class="muted" th:text="${#temporals.format(resume.createdAt, 'yyyy.MM.dd HH:mm')}"></p>
            <p class="resume-preview"
               th:text="${#strings.abbreviate(resume.selfIntroduction, 120)}"></p>
            <div style="margin-top: 10px; font-size: 14px; font-weight: 600;"
                 th:styleappend="${resume.isPublic} ? 'color: var(--color-cta-green);' : 'color: var(--color-danger);'">
                <span th:text="${resume.isPublic} ? '✅ 공개 중' : '🔒 비공개'"></span>
            </div>
            <div class="card-actions">
                <form th:action="@{'/resumes/' + ${resume.id} + '/toggle-public'}" method="post">
                    <button th:classappend="${resume.isPublic} ? 'btn-danger small btn-toggle-width' : 'btn-outline small btn-toggle-width'" type="submit"
                            th:text="${resume.isPublic} ? '비공개 전환' : '공개 전환'"></button>
                </form>

                <a th:href="@{'/resumes/' + ${resume.id} + '/edit'}" class="btn-outline small btn-action-width">수정</a>
                <form th:action="@{'/resumes/' + ${resume.id} + '/delete'}" method="post"
                      onsubmit="return confirm('삭제할까요?');">
                    <button class="btn-danger small btn-action-width" type="submit">삭제</button>
                </form>
            </div>
        </div>
    </div>

    <div th:if="${#lists.isEmpty(resumes)}" class="empty">
        아직 등록된 이력서가 없습니다. <a th:href="@{/resumes/new}">첫 이력서를 작성해보세요.</a>
    </div>
</th:block>
</body>
</html>